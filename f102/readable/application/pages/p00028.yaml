---
# ====== Page: DL_INTERFACE ==================================
id: 28
identification: 
  name: DL_INTERFACE
  alias: DL-INTERFACE
  title: Cargar interfaces

appearance: 
  page-mode: Modal Dialog
  dialog-template: Theme Default
  template-options: 
  - '#DEFAULT#'

dialog: 
  chained: true
  resizable: true

navigation-menu: 
  override-user-interface-level: false

navigation: 
  cursor-focus: Do not focus cursor
  warn-on-unsaved-changes: true

security: 
  authentication: Page Requires Authentication
  deep-linking: Application Default
  page-access-protection: Arguments Must Have Checksum
  form-auto-complete: Off
  browser-cache: Application Default

session-management: 
  rejoin-sessions: Application Default

advanced: 
  enable-duplicate-page-submissions: Yes - Enable page to be re-posted
  reload-on-submit: Only for Success

server-cache: 
  caching: Disabled

regions: 
- # ====== Region: Log eventos =================================
  id: 40532532474723
  identification: 
    name: Log eventos
    type: Static Content

  source: 
    html-code: '&P28_LOGGER.'

  layout: 
    sequence: 10
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item is NOT NULL
    item: P28_ERROR_ROW_COUNT

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: HTML
      expand-shortcuts: false

- # ====== Region: Button Bar ==================================
  id: 38501679099902165444
  identification: 
    name: Button Bar
    type: Static Content

  layout: 
    sequence: 20
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Buttons Container
    template-options: 
    - '#DEFAULT#'
    - t-ButtonRegion--noUI
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item is NOT NULL
    item: P28_FILE

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: Text (escape special characters)
      show-line-breaks: true

- # ====== Region: Data Source =================================
  id: 38501681022343165446
  identification: 
    name: Data Source
    type: Static Content

  layout: 
    sequence: 30
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--hideHeader js-addHiddenHeadingRoleDesc
    - t-Region--noUI
    - t-Region--scrollBody
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: Text (escape special characters)
      show-line-breaks: true

- # ====== Region: Upload a File ===============================
  id: 38501681426448165447
  identification: 
    name: Upload a File
    type: Static Content

  layout: 
    sequence: 30
    parent-region: Data Source # 38501681022343165446
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Blank with Attributes
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item is NULL
    item: P28_FILE

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: Text (escape special characters)
      show-line-breaks: true

- # ====== Region: Loaded File =================================
  id: 38501683612292165451
  identification: 
    name: Loaded File
    type: Static Content

  layout: 
    sequence: 40
    parent-region: Data Source # 38501681022343165446
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Blank with Attributes
    template-options: 
    - '#DEFAULT#'
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  header-and-footer: 
    header-text: Puede subir un archivo los nombres de las interfaces deben ser únicos para cada equipo, tenga en cuenta los valores posibles para cada campo requerido, puede chequear estos valores en el formulario de agregar.

  server-side-condition: 
    type: Item is NOT NULL
    item: P28_FILE

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    settings: 
      output-as: Text (escape special characters)
      show-line-breaks: true

- # ====== Region: Preview =====================================
  id: 38501686514577165454
  identification: 
    name: Preview
    type: Classic Report

  source: 
    location: Local Database
    type: SQL Query
    sql-query: |
      select p.line_number,
             p.col001,p.col002, p.col003, p.col004, p.col005, p.col006, p.col007, p.col008, p.col009, p.col010,
             p.col011,p.col012,p.col013,p.col014
             -- add more columns (col011 to col300) here.
        from apex_application_temp_files f, 
             table( apex_data_parser.parse(
                        p_content           => f.blob_content,
                        p_file_name         => f.filename,
                        p_xlsx_sheet_name   => case when :P28_XLSX_WORKSHEET is not null then :P28_XLSX_WORKSHEET end,
                        --p_file_profile      => apex_data_loading.get_file_profile( p_static_id => 'dl_interfaces' ),
                        p_max_rows          => 100 ) ) p
       where f.name = :P28_FILE
      
      order by line_number

  order-by: 
    type: None

  layout: 
    sequence: 40
    parent-region: No Parent
    slot: BODY
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    template: Standard
    template-options: 
    - '#DEFAULT#'
    - t-Region--noPadding
    render-components: Above Content

  accessibility: 
    use-landmark: true
    landmark-type: Template Default

  advanced: 
    region-display-selector: false
    exclude-title-from-translation: false

  server-side-condition: 
    type: Item is NOT NULL
    item: P28_FILE

  server-cache: 
    caching: Disabled

  customization: 
    customizable: Not Customizable By End Users

  attributes: 
    layout: 
      number-of-rows-type: Static Value
      number-of-rows: 50

    appearance: 
      template-type: Theme
      template: Standard
      template-options: 
      - '#DEFAULT#'
      - t-Report--stretch
      - t-Report--staticRowColors
      - t-Report--rowHighlight
      - t-Report--horizontalBorders
      - t-Report--hideNoPagination

    pagination: 
      type: Row Ranges X to Y (with next and previous links)
      display-position: Bottom - Right
      partial-page-refresh: true

    performance: 
      lazy-loading: false
      maximum-rows-to-process: 500

    messages: 
      when-no-data-found: no data found

    break-formatting: 
      break-columns: No Break

    advanced: 
      strip-html: false
      sort-nulls: Last

    heading: 
      type: None

    download: 
      csv-export-enabled: false

    printing: 
      enabled: false

  columns: 
  - # ====== Column: COL011 ======================================
    id: 39816838474716
    identification: 
      column-name: COL011
      type: Plain Text

    heading: 
      heading: Col011
      alignment: start

    layout: 
      sequence: 102
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL012 ======================================
    id: 39904350474717
    identification: 
      column-name: COL012
      type: Plain Text

    heading: 
      heading: Col012
      alignment: start

    layout: 
      sequence: 112
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL013 ======================================
    id: 39962568474718
    identification: 
      column-name: COL013
      type: Plain Text

    heading: 
      heading: Col013
      alignment: start

    layout: 
      sequence: 122
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL014 ======================================
    id: 40107637474719
    identification: 
      column-name: COL014
      type: Plain Text

    heading: 
      heading: Col014
      alignment: start

    layout: 
      sequence: 132
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL002 ======================================
    id: 40380244474722
    identification: 
      column-name: COL002
      type: Plain Text

    heading: 
      heading: Col002
      alignment: start

    layout: 
      sequence: 12
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: LINE_NUMBER =================================
    id: 38501686965090165459
    identification: 
      column-name: LINE_NUMBER
      type: Plain Text

    heading: 
      heading: Line Number
      alignment: end

    layout: 
      sequence: 1
      column-alignment: end

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL001 ======================================
    id: 38501687327095165460
    identification: 
      column-name: COL001
      type: Plain Text

    heading: 
      heading: Col001
      alignment: start

    layout: 
      sequence: 2
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL003 ======================================
    id: 38501688140903165460
    identification: 
      column-name: COL003
      type: Plain Text

    heading: 
      heading: Col003
      alignment: start

    layout: 
      sequence: 22
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL004 ======================================
    id: 38501688523743165461
    identification: 
      column-name: COL004
      type: Plain Text

    heading: 
      heading: Col004
      alignment: start

    layout: 
      sequence: 32
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL005 ======================================
    id: 38501688833617165461
    identification: 
      column-name: COL005
      type: Plain Text

    heading: 
      heading: Col005
      alignment: start

    layout: 
      sequence: 42
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL006 ======================================
    id: 38501689240107165461
    identification: 
      column-name: COL006
      type: Plain Text

    heading: 
      heading: Col006
      alignment: start

    layout: 
      sequence: 52
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL007 ======================================
    id: 38501689697472165462
    identification: 
      column-name: COL007
      type: Plain Text

    heading: 
      heading: Col007
      alignment: start

    layout: 
      sequence: 62
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL008 ======================================
    id: 38501690008158165462
    identification: 
      column-name: COL008
      type: Plain Text

    heading: 
      heading: Col008
      alignment: start

    layout: 
      sequence: 72
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL009 ======================================
    id: 38501690499264165462
    identification: 
      column-name: COL009
      type: Plain Text

    heading: 
      heading: Col009
      alignment: start

    layout: 
      sequence: 82
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

  - # ====== Column: COL010 ======================================
    id: 38501690894365165462
    identification: 
      column-name: COL010
      type: Plain Text

    heading: 
      heading: Col010
      alignment: start

    layout: 
      sequence: 92
      column-alignment: start

    accessibility: 
      value-identifies-row: false

    sorting: 
      sortable: false

    export-/-printing: 
      include-in-export-/-print: true

    advanced: 
      compute-sum: false

    ui-defaults-reference: 
      table-owner: Parsing Schema

    security: 
      escape-special-characters: true

page-items: 
- # ====== Page Item: P28_LOGGER ===============================
  id: 40595322474724
  identification: 
    name: P28_LOGGER
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 10
    region: Log eventos # 40532532474723
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P28_ERRORES ==============================
  id: 40715946474725
  identification: 
    name: P28_ERRORES
    type: Hidden

  settings: 
    value-protected: false

  layout: 
    sequence: 50
    region: Loaded File # 38501683612292165451
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P28_FILE =================================
  id: 38501681850808165449
  identification: 
    name: P28_FILE
    type: File Upload

  label: 
    label: Upload a File
    alignment: Left

  display: 
    display-as: Block Dropzone
    dropzone-title: Suba un archivo con interfaces
    dropzone-description: 'Formato soportado: XLSX'
    capture-using: NONE

  storage:: 
    type: Table APEX_APPLICATION_TEMP_FILES
    purge-file-at: End of Session
    allow-multiple-files: false
    file-types: .xlsx
    maximum-file-size: 100

  layout: 
    sequence: 10
    region: Upload a File # 38501681426448165447
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: 0

  appearance: 
    template: Hidden
    template-options: 
    - '#DEFAULT#'
    - t-Form-fieldContainer--stretchInputs

  validation: 
    value-required: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    restricted-characters: All characters can be saved.

  help: 
    inline-help-text: Archivo XLS, hasta 100 registros
    help-text: Puede subir un archivo con el formato sugerido, soporta hasta 100 registros, seleccione el equipo de la lista de equipos

- # ====== Page Item: P28_ERROR_ROW_COUNT ======================
  id: 38501682362071165450
  identification: 
    name: P28_ERROR_ROW_COUNT
    type: Hidden

  settings: 
    value-protected: true

  layout: 
    sequence: 20
    region: Upload a File # 38501681426448165447
    slot: BODY

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P28_FILE_NAME ============================
  id: 38501684084785165452
  identification: 
    name: P28_FILE_NAME
    type: Display Only

  label: 
    label: Loaded File
    alignment: Left

  settings: 
    format: Plain Text
    based-on: Item Value
    show-line-breaks: true
    send-on-page-submit: true

  layout: 
    sequence: 30
    region: Loaded File # 38501683612292165451
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional - Floating
    template-options: 
    - '#DEFAULT#'

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  default: 
    type: Static
    static-value: Pasted Data

  session-state: 
    data-type: VARCHAR2
    storage: Per Session (Persistent)

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P28_XLSX_WORKSHEET =======================
  id: 38501685227026165453
  identification: 
    name: P28_XLSX_WORKSHEET
    type: Select List

  label: 
    label: XLSX Worksheet
    alignment: Left

  settings: 
    page-action-on-selection: None

  multiple-values: 
    type: No

  layout: 
    sequence: 40
    region: Loaded File # 38501683612292165451
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional - Floating
    template-options: 
    - '#DEFAULT#'
    height: 1

  validation: 
    value-required: false

  list-of-values: 
    type: SQL Query
    sql-query: |
      select p.sheet_display_name,
             p.sheet_file_name
        from apex_application_temp_files f,
             table( apex_data_parser.get_xlsx_worksheets( p_content => f.blob_content ) ) p
       where f.name = :P28_FILE
    display-extra-values: false
    display-null-value: false

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  server-side-condition: 
    type: Function Body
    language: PL/SQL
    pl/sql-function-body: |
      declare
          l_sheet_count number;
      begin
          select count(*)
            into l_sheet_count
            from apex_application_temp_files f,
                 table( apex_data_parser.get_xlsx_worksheets( p_content => f.blob_content ) ) p
           where f.name = :P28_FILE;
          
           -- display if the XSLX file contains multiple worksheets
          return ( l_sheet_count > 1 );
      exception
          when others then 
              return false;
      end;

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P28_EQUIPOS ==============================
  id: 40618571696428809127
  identification: 
    name: P28_EQUIPOS
    type: Popup LOV

  label: 
    label: Equipos
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    manual-entry: false
    fetch-on-search: false

  search: 
    match-type: Contains
    case-sensitive: false
    minimum-characters: 0

  multiple-values: 
    type: No

  layout: 
    sequence: 10
    region: Loaded File # 38501683612292165451
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: false
    column: Automatic
    new-column: false
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Required - Floating
    template-options: 
    - '#DEFAULT#'
    width: 30
    value-placeholder: Seleccione un item

  validation: 
    value-required: true

  list-of-values: 
    type: Shared Component
    list-of-values: EQUIPOS.NOMBRE-COMPUESTO # 99183333741246371784
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

- # ====== Page Item: P28_TIPO_INTERFAZ ========================
  id: 40903512045130394921
  identification: 
    name: P28_TIPO_INTERFAZ
    type: Popup LOV

  label: 
    label: Tipo Interfaz
    alignment: Left

  settings: 
    display-as: Inline Popup
    initial-fetch: Automatic
    manual-entry: false
    fetch-on-search: false

  search: 
    match-type: Contains
    case-sensitive: false
    minimum-characters: 0

  multiple-values: 
    type: No

  layout: 
    sequence: 20
    region: Loaded File # 38501683612292165451
    slot: BODY
    alignment: Left
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic
    label-column-span: Page Template Default

  appearance: 
    template: Optional - Floating
    template-options: 
    - '#DEFAULT#'
    width: 30

  validation: 
    value-required: false

  list-of-values: 
    type: Shared Component
    list-of-values: TIPO_INTERFAZ.NOMBRE # 41082575549472967716
    display-extra-values: true
    display-null-value: true

  advanced: 
    warn-on-unsaved-changes: Page Default

  source: 
    type: Null
    used: Only when current value in session state is null

  session-state: 
    storage: Per Session (Persistent)

  quick-picks: 
    show-quick-picks: false

  security: 
    session-state-protection: Unrestricted
    store-value-encrypted-in-session-state: true
    restricted-characters: All characters can be saved.

  configuration: 
    build-option: Commented Out # 197180071872965446203

buttons: 
- # ====== Button: CLEAR =======================================
  id: 38501679553089165445
  identification: 
    button-name: CLEAR
    label: Clear

  layout: 
    sequence: 10
    region: Button Bar # 38501679099902165444
    slot: NEXT
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'

  behavior: 
    action: Submit Page
    execute-validations: true
    show-processing: false
    warn-on-unsaved-changes: Do Not Check

- # ====== Button: LOAD ========================================
  id: 38501679833885165446
  identification: 
    button-name: LOAD
    label: Insertar

  layout: 
    sequence: 20
    region: Button Bar # 38501679099902165444
    slot: NEXT
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text
    hot: true
    template-options: 
    - '#DEFAULT#'

  behavior: 
    action: Submit Page
    execute-validations: true
    show-processing: false
    warn-on-unsaved-changes: Do Not Check

- # ====== Button: FUNCTION_LOAD ===============================
  id: 40903511972562394920
  identification: 
    button-name: FUNCTION_LOAD
    label: Function Load

  layout: 
    sequence: 30
    region: Button Bar # 38501679099902165444
    slot: NEXT
    start-new-layout: false
    start-new-row: true
    column: Automatic
    new-column: true
    column-span: Automatic

  appearance: 
    button-template: Text
    hot: false
    template-options: 
    - '#DEFAULT#'

  behavior: 
    action: Submit Page
    execute-validations: true
    show-processing: false
    warn-on-unsaved-changes: Do Not Check

  configuration: 
    build-option: Commented Out # 197180071872965446203

dynamic-actions: 
- # ====== Dynamic Action: Upload a File =======================
  id: 38501682701320165451
  identification: 
    name: Upload a File

  execution: 
    sequence: 10
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P28_FILE

  client-side-condition: 
    type: Item is not null
    item: P28_FILE

  actions: 
  - # ====== Action: Submit Page =================================
    id: 38501683258239165451
    identification: 
      action: Submit Page

    settings: 
      show-processing: true

    execution: 
      sequence: 10
      event: Upload a File # 38501682701320165451
      fire-when-event-result-is: True
      fire-on-initialization: false

- # ====== Dynamic Action: Submit worksheet on change ==========
  id: 38501685613309165453
  identification: 
    name: Submit worksheet on change

  execution: 
    sequence: 20
    event-scope: Static
    type: Immediate

  when: 
    event: Change
    selection-type: Item(s)
    item(s): 
    - P28_XLSX_WORKSHEET

  actions: 
  - # ====== Action: Submit Page =================================
    id: 38501686168715165453
    identification: 
      action: Submit Page

    settings: 
      show-processing: true

    execution: 
      sequence: 10
      event: Submit worksheet on change # 38501685613309165453
      fire-when-event-result-is: True
      fire-on-initialization: false

validations: 
- # ====== Validation: Is valid file type ======================
  id: 38501684969455165452
  identification: 
    name: Is valid file type

  execution: 
    sequence: 10

  validation: 
    type: Function Body (returning Boolean)
    language: PL/SQL
    pl/sql-function-body: |
      if apex_data_parser.assert_file_type(
             p_file_name => :P28_FILE_NAME,
             p_file_type => apex_data_parser.c_file_type_xlsx )
      then
          return true;
      else
          :P28_FILE := null;
          return false;
      end if;
    always-execute: false

  error: 
    error-message: Invalid file type. Supported file types XLSX.
    display-location: Inline with Field and in Notification
    associated-item: P28_FILE # 38501681850808165449

computations: 
- # ====== Computation: P28_FILE_NAME ==========================
  id: 38501684597729165452
  identification: 
    item-name: P28_FILE_NAME

  execution: 
    sequence: 10
    point: After Submit

  computation: 
    type: SQL Query (return single value)
    sql-query: |
      select filename
        from apex_application_temp_files 
       where name = :P28_FILE

  server-side-condition: 
    type: Item is NOT NULL
    item: P28_FILE

processes: 
- # ====== Process: PROCESAR_XLS ===============================
  id: 40202923474720
  identification: 
    name: PROCESAR_XLS
    type: Execute Code
    execution-chain: None

  source: 
    location: Local Database
    language: PL/SQL
    pl/sql-code: |
      DECLARE
          v_filas_insertadas NUMBER := 0;
          v_count_parseo NUMBER := 0;
          v_count NUMBER := 0;
          v_error_count NUMBER := 0;
          v_fila NUMBER :=0;
      BEGIN
          -- Información de depuración
          apex_debug.info('File Name: ' || :P28_FILE_NAME);
          apex_debug.info('Archivo: ' || :P28_XLSX_WORKSHEET);
      
          -- Bucle por cada fila del archivo
          FOR p IN (
              SELECT *
              FROM apex_application_temp_files f,
                   TABLE(apex_data_parser.parse(
                       p_content   => f.blob_content,
                       p_file_name => f.filename,
                       p_skip_rows => 1
                   )) tab
              WHERE f.name = :P28_FILE
                AND col006 IS NOT NULL
          ) LOOP
      
              BEGIN
                  -- Intentar insertar cada fila
                  INSERT INTO SGT_INTERFACES (
                      EQUIPO_ID,
                      NOMBRE,
                      ETIQUETA,
                      ESTADO,
                      MODO,
                      DUPLEX,
                      TIPO_INTERFACE_ID,
                      TX_EN_DBM,
                      RX_EN_DBM,
                      MAC_ADDRESS,
                      NUMERO_SERIE,
                      HW_VERSION,
                      SW_VERSION
                  ) VALUES (
                      :P28_EQUIPOS,
                      p.col001,
                      p.col002,
                      UPPER(p.col003),
                      UPPER(p.col004),
                      UPPER(p.col005),
                      F_GET_LOVS(2, p.col006),
                      p.col007,
                      p.col008,
                      p.col009,
                      p.col010,
                      p.col011,
                      p.col012
                  );
      
                  v_count := v_count + 1;
      
              EXCEPTION
                  WHEN DUP_VAL_ON_INDEX THEN
                      v_error_count := v_error_count + 1;
                      apex_debug.error('Fila duplicada: ' || SQLERRM);
                      CONTINUE;
      
                  WHEN OTHERS THEN
                      v_error_count := v_error_count + 1;
                      apex_debug.error('Error en fila ' || TO_CHAR(v_count + v_error_count) || ': ' || SQLERRM);
                      CONTINUE;
              END;
      
          END LOOP;
      
          :P28_ERROR_ROW_COUNT := v_error_count;
          :P28_LOGGER := 'Registros insertados: ' || v_count || ', Errores: ' || v_error_count;
      
          apex_debug.info('Registros insertados: ' || v_count);
          apex_debug.info('Errores: ' || v_error_count);
      
         
      END;
      

  execution: 
    sequence: 20
    point: Processing
    run-process: Once Per Page Visit (default)

  success-message: 
    success-message: '&P28_LOGGER.'

  error: 
    error-message: '&P28_LOGGER.'
    display-location: Inline in Notification

  server-side-condition: 
    when-button-pressed: LOAD # 38501679833885165446

  security: 
    authorization-scheme: Implementador Rights # 56843702980053272617

- # ====== Process: Close Dialog ===============================
  id: 40287881474721
  identification: 
    name: Close Dialog
    type: Close Dialog
    execution-chain: None

  settings: 
    show-success-messages: true

  execution: 
    sequence: 50
    point: Processing
    run-process: Once Per Page Visit (default)

  error: 
    display-location: Inline in Notification

  server-side-condition: 
    when-button-pressed: LOAD # 38501679833885165446

- # ====== Process: Clear Cache ================================
  id: 38501680708706165446
  identification: 
    name: Clear Cache
    type: Clear Session State
    execution-chain: None

  settings: 
    type: Clear all Items on the Current Page

  execution: 
    sequence: 30
    point: Processing
    run-process: Once Per Page Visit (default)

  error: 
    display-location: Inline in Notification

  server-side-condition: 
    type: Expression
    language: PL/SQL
    pl/sql-expression: ":REQUEST = 'CLEAR' or :P28_ERROR_ROW_COUNT = 0"

