DROP TABLE "SGT_INTERFACES_L2" ;
DROP TABLE "SGT_INTERFACES_L3" ;
DROP TABLE "SGT_IP_ADM" ;

CREATE TABLE "SGT_INTERFACES_L2" 
   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"INTERFACE_ID" NUMBER, 
	"TIPO_VLAN" VARCHAR2(255), 
	"VLAN" VARCHAR2(1000), 
	"L2_VC_ID" VARCHAR2(255), 
	"LS_TX_RX_LABEL" VARCHAR2(255), 
    "TIPO_MPLS" VARCHAR2(50), 
	"CREADO_EL" TIMESTAMP (6), 
	"ACTUALIZADO_EL" TIMESTAMP (6), 
	"ACTUALIZADO_POR" VARCHAR2(255), 
	"CREADO_POR" VARCHAR2(255), 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "SGT_INTERFACES_L2" ADD CONSTRAINT "SGT_INTERFACES_L2_FK" FOREIGN KEY ("INTERFACE_ID")
	  REFERENCES "SGT_INTERFACES" ("ID") ENABLE;

  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_ST_SGT_INTERFACES_L2" 
before 
insert or update on "SGT_INTERFACES_L2" 
FOR EACH ROW  
BEGIN  
    IF INSERTING THEN  
        :NEW.creado_el := SYSDATE;  
        :NEW.creado_por := nvl(wwv_flow.g_user,user);  
        :NEW.actualizado_el := SYSDATE;  
        :NEW.ACTUALIZADO_POR := nvl(wwv_flow.g_user,user);  
    ELSIF UPDATING THEN  
        :NEW.actualizado_el := SYSDATE;  
        :NEW.ACTUALIZADO_POR := nvl(wwv_flow.g_user,user);  
    END IF;  
END;
/
ALTER TRIGGER "TRG_ST_SGT_INTERFACES_L2" ENABLE;

  CREATE TABLE "SGT_INTERFACES_L3" 
   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"INTERFACE_ID" NUMBER, 
	"NUM_BGP" VARCHAR2(50), 
	"VPN_INSTANCE" VARCHAR2(50), 
	"ROUTER_ID" VARCHAR2(45), 
	"PROCESO_OSPF" VARCHAR2(100), 
	"OSPF_AREA" VARCHAR2(100), 
	"CREADO_EL" TIMESTAMP (6), 
	"ACTUALIZADO_EL" TIMESTAMP (6), 
	"ACTUALIZADO_POR" VARCHAR2(255), 
	"CREADO_POR" VARCHAR2(255), 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "SGT_INTERFACES_L3" ADD CONSTRAINT "SGT_INTERFACES_L3_FK" FOREIGN KEY ("INTERFACE_ID")
	  REFERENCES "SGT_INTERFACES" ("ID") ENABLE;

  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_ST_SGT_INTERFACES_L3" 
before 
insert or update on "SGT_INTERFACES_L3" 
FOR EACH ROW  
BEGIN  
    IF INSERTING THEN  
        :NEW.creado_el := SYSDATE;  
        :NEW.creado_por := nvl(wwv_flow.g_user,user);  
        :NEW.actualizado_el := SYSDATE;  
        :NEW.ACTUALIZADO_POR := nvl(wwv_flow.g_user,user);  
    ELSIF UPDATING THEN  
        :NEW.actualizado_el := SYSDATE;  
        :NEW.ACTUALIZADO_POR := nvl(wwv_flow.g_user,user);  
    END IF;  
END;
/
ALTER TRIGGER "TRG_ST_SGT_INTERFACES_L3" ENABLE;

  CREATE TABLE "SGT_IP_ADM" 
   (	"ID" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"INTERFACE_ID" NUMBER, 
	"IP" VARCHAR2(45), 
	"MASK" VARCHAR2(45), 
	"GW" VARCHAR2(45), 
	"ESTADO" VARCHAR2(50), 
	"CREADO_EL" TIMESTAMP (6), 
	"ACTUALIZADO_EL" TIMESTAMP (6), 
	"ACTUALIZADO_POR" VARCHAR2(255), 
	"CREADO_POR" VARCHAR2(255), 
	 PRIMARY KEY ("ID")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "SGT_IP_ADM" ADD CONSTRAINT "SGT_IP_ADM_FK" FOREIGN KEY ("INTERFACE_ID")
	  REFERENCES "SGT_INTERFACES" ("ID") ENABLE;

  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_ST_SGT_IP_ADM" 
before 
insert or update on "SGT_IP_ADM" 
for each row 
begin 
    --actualizar info de   
    IF INSERTING THEN  
        :NEW.creado_el := SYSDATE;  
        :NEW.creado_por := nvl(wwv_flow.g_user,user);  
        :NEW.actualizado_el := SYSDATE;  
        :NEW.ACTUALIZADO_POR := nvl(wwv_flow.g_user,user);  
    ELSIF UPDATING THEN  
        :NEW.actualizado_el := SYSDATE;  
        :NEW.ACTUALIZADO_POR := nvl(wwv_flow.g_user,user);  
    END IF;  
end;
/
ALTER TRIGGER "TRG_ST_SGT_IP_ADM" ENABLE;